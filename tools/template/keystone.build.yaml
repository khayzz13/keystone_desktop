# {{APP_NAME}} — Build Configuration
# Build-time settings. Runtime config lives in keystone.config.json.

# ── Paths ─────────────────────────────────────────────────────────────────────
# All paths relative to this file, or absolute.

app_directory: "."                   # app root (contains keystone.config.json)
framework_directory: "../keystone"   # Keystone engine source or distribution

# Source layout relative to app_directory.
# bun_directory must match bun.root in keystone.config.json.
bun_directory: "bun"
dylib_directory: "dylib"             # C# plugin DLL output directory

# ── C# Build Order ──────────────────────────────────────────────────────────
# Format: "priority:path" — lower priority builds first.
# Path can be a .csproj file or a directory (builds all .csproj in it).
# build_cs:
#   core: "1:app/App.Core.csproj"
#   plugins: "2:plugins"

# ── Plugins ───────────────────────────────────────────────────────────────────
plugins:
  # How C# plugins are delivered in the packaged .app bundle:
  #   side-by-side  dylib/ stays adjacent to the .app — supports hot-reload and 3rd-party dev
  #   bundled       plugin DLLs are embedded inside the bundle (immutable, no hot-reload)
  mode: side-by-side

  # Directory for 3rd-party plugin developers to load test builds from during dev (--run).
  # Never included in the packaged bundle. Absolute path or ~/... recommended.
  # dev_extensions_directory: "~/Library/Application Support/{{APP_NAME}}/DevPlugins"

  # Allow loading plugin DLLs signed by developer teams other than the app signing identity.
  # Required if 3rd-party developers distribute independently-signed plugin builds.
  allow_external_signatures: false

# ── Distribution Packaging ────────────────────────────────────────────────────
# Settings for: python3 build.py --package
package:
  out_directory: "dist"
  category: public.app-category.utilities
  minimum_system_version: "15.0"

  # Dev mode: ship Bun services + web components as source files with hot-reload.
  # Production mode (default): compile everything into the exe, pre-bundle web assets.
  dev_mode: false

  # Create a .dmg alongside the .app after packaging.
  dmg: false

  # Code signing. "-" = ad-hoc (local/dev only — Gatekeeper will reject for distribution).
  signing_identity: "-"
  require_signing_identity: false    # fail if signing_identity is ad-hoc
  notarize: false                    # submit to Apple notarization after signing
  # notary_profile: "my-profile"    # xcrun notarytool keychain profile name

  # Additional files or directories to copy into the bundle Resources/ unchanged.
  # extra_resources: []
